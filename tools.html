<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ScholarshipFinder - AI Search</title>
<link rel="shortcut icon" href="core/assets/images/favicon.ico" type="image/x-icon">
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
/>

<style>
  i {
  margin-right: 6px;
}

/* -------------------- GLOBAL -------------------- */
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  min-height: 100vh;
  padding: 20px;
  line-height: 1.6;
  color: #eee;

  background: 
    linear-gradient(rgba(30, 30, 30, 0.959), rgba(30,30,30,0.85)),
    url("core/assets/images/favicon.ico") center / cover no-repeat fixed;
}

.container { max-width: 900px; margin:0 auto; }

/* -------------------- HEADER -------------------- */
.header { text-align:center; margin-bottom:40px; }
.header h1 { font-size:2.8em; margin-bottom:5px; color:#FFD700; font-weight:700; } /* Yellow heading */
.header p { color:#bbb; font-size:1.1em; }

/* -------------------- API CONFIG -------------------- */
.api-section { display:flex; flex-direction:column; gap:20px; margin-bottom:30px; }
.api-card { display:flex; flex-direction:column; gap:8px; }
.api-card h3 { font-size:1.3em; color:#FFD700; margin-bottom:5px; }
.api-input-group label { font-size:0.9em; color:#ccc; }
.api-input-group input { width:100%; padding:10px; border:none; border-bottom:2px solid #555; background:transparent; color:#eee; font-family: monospace; font-size:14px; outline:none; }
.api-input-group input:focus { border-bottom-color:#FFD700; }
.api-status { display:flex; align-items:center; gap:8px; font-size:0.9em; color:#ccc; }
.status-dot { width:10px; height:10px; border-radius:50%; background:#ff6b6b; }
.status-dot.connected { background:#FFD700; animation: pulse 1.5s infinite; }
.api-actions { display:flex; gap:10px; margin-top:15px; }

/* -------------------- SEARCH -------------------- */
.search-section { display:none; margin-bottom:30px; }
.search-section.active { display:block; }
.search-controls { display:flex; gap:10px; flex-wrap:wrap; }
#searchInput { flex:1; padding:12px; border:2px solid #555; border-radius:6px; background:transparent; color:#eee; outline:none; }
#searchInput:focus { border-color:#FFD700; }
#aiProvider { padding:10px; border:2px solid #555; border-radius:6px; background:transparent; color:#eee; outline:none; min-width:180px; }
button { padding:10px 18px; border:none; border-radius:6px; font-size:14px; font-weight:600; cursor:pointer; background:#FFD700; color:#1e1e1e; transition:0.2s; }
button:hover { background:#e6c200; }

/* -------------------- RESULTS -------------------- */
.results-section { display:none; margin-bottom:20px; }
.results-section.active { display:block; }
.response-card { background:transparent; border-bottom:1px solid #555; padding:10px 0; }
.response-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:5px; font-size:0.9em; color:#ccc; }
.provider-badge { font-weight:600; font-size:1em; color:#FFD700; }
.response-time { color:#888; font-size:0.8em; }
.response-content { color:#eee; white-space:pre-wrap; }
.loading { display:none; text-align:center; padding:20px; }
.loading.active { display:block; }
.spinner { border:3px solid #444; border-top:3px solid #FFD700; border-radius:50%; width:30px; height:30px; animation:spin 1s linear infinite; margin:0 auto 10px; }

/* -------------------- STATUS BAR -------------------- */
.status-bar { margin-top:20px; padding:10px; display:flex; align-items:center; gap:10px; }
.global-status { width:12px; height:12px; border-radius:50%; background:#ff6b6b; }
.global-status.connected { background:#FFD700; animation:pulse 1.5s infinite; }
.error { color:#ff6b6b; }

@keyframes spin { 0%{transform:rotate(0deg);} 100%{transform:rotate(360deg);} }
@keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.3); } 100% { transform: scale(1); } }

.home-link a {
  color: #bbb;
  text-decoration: none;
  font-size: 1.05em;
  display: inline-flex;
  align-items: center;
  gap: 6px;
  transition: 0.25s ease;
}

.home-link a:hover {
  color: #FFD700;
  text-shadow: 0 0 8px rgba(255, 215, 0, 0.6);
}

.home-link i {
  font-size: 0.9em;
}


</style>
</head>
<body>
<div class="container">
  <div class="header">
<h1><i class="fa-solid fa-graduation-cap"></i> ScholarshipFinder</h1>
 <p class="home-link">
  <a href="index.html">
    <i class="fa-solid fa-house"></i>ACADLINK
  </a>
</p>
  </div>

  <!-- API CONFIGURATION -->
  <div class="api-section" id="apiSection">
    <div class="api-card">
 <h3><i class="fa-solid fa-brain"></i> DeepSeek API</h3>
      <div class="api-input-group">
        <label>API KEY</label>
        <input type="password" id="deepseekKey" placeholder="sk-xxxxxxxxxxxx">
      </div>
      <div class="api-status">
        <div class="status-dot" id="deepseekStatus"></div>
        <span id="deepseekStatusText">Not configured</span>
      </div>
    </div>
    <div class="api-card">
<h3><i class="fa-solid fa-robot"></i> Ollama API</h3>
      <div class="api-input-group">
        <label>API KEY</label>
        <input type="password" id="ollamaKey" placeholder="xai-xxxxxxxxxxxx">
      </div>
      <div class="api-status">
        <div class="status-dot" id="ollamaStatus"></div>
        <span id="ollamaStatusText">Not configured</span>
      </div>
    </div>
    <div class="api-actions">
<button id="testApisBtn">
  <i class="fa-solid fa-plug"></i> Test Connections
</button>
<button id="saveConfigBtn">
  <i class="fa-solid fa-floppy-disk"></i> Save Keys
</button>

    </div>
  </div>

  <!-- SEARCH -->
  <div class="search-section" id="searchSection">
    <div class="search-controls">
      <input type="text" id="searchInput" placeholder="Enter your search query...">
      <select id="aiProvider">
        <option value="deepseek">DeepSeek Only</option>
        <option value="ollama">Ollama Only</option>
        <option value="compare">Compare Both</option>
      </select>
 <button id="searchBtn">
  <i class="fa-solid fa-magnifying-glass"></i> SEARCH
</button>

    </div>
  </div>

  <!-- LOADING -->
  <div class="loading" id="loading">
    <div class="spinner"></div>
<p><i class="fa-solid fa-shield-halved"></i> Connecting to AI systems...</p>

  </div>

  <!-- RESULTS -->
  <div class="results-section" id="resultsSection">
    <div id="resultsArea"></div>
  </div>

  <!-- STATUS BAR -->
  <div class="status-bar">
    <div class="global-status" id="globalStatus"></div>
    <span id="statusText">APP: Configure API keys to begin</span>
  </div>
</div>

<script>
// JS is same as previous version, only DeepSeek and Ollama
const API_CONFIG = {
  deepseek: { name: 'DeepSeek', baseURL: 'https://api.deepseek.com/v1', endpoints: { chat: '/chat/completions', models: '/models' } },
  ollama: { name: 'Ollama', baseURL: 'https://api.x.ai/v1', endpoints: { chat: '/chat/completions', models: '/models' } }
};

function updateApiStatus(provider, status, message='') {
  const dot = document.getElementById(provider+'Status');
  const text = document.getElementById(provider+'StatusText');
  if(status==='connected'){ dot.className='status-dot connected'; text.textContent='Connected ✓'; text.style.color='#FFD700'; }
  else if(status==='saved'){ dot.className='status-dot'; text.textContent='Configured (not tested)'; text.style.color='#ffa500'; }
  else if(status==='error'){ dot.className='status-dot'; text.textContent=message||'Connection failed'; text.style.color='#ff4444'; }
  else{ dot.className='status-dot'; text.textContent='Not configured'; text.style.color='#ccc'; }
}

function loadApiKeys(){ ['deepseek','ollama'].forEach(p=>{ const key = localStorage.getItem(p+'_api_key'); if(key){ document.getElementById(p+'Key').value=key; updateApiStatus(p,'saved'); } }); }
async function testApiConnection(provider){
  const key = document.getElementById(provider+'Key').value;
  if(!key){ updateApiStatus(provider,'error','No API key'); return false; }
  try{
    const res = await fetch(API_CONFIG[provider].baseURL+API_CONFIG[provider].endpoints.models,{method:'GET', headers:{'Authorization':`Bearer ${key}`,'Content-Type':'application/json'}});
    if(res.status===401){ updateApiStatus(provider,'error','Invalid API key'); return false; }
    else if(!res.ok){ updateApiStatus(provider,'error',`HTTP ${res.status}`); return false; }
    updateApiStatus(provider,'connected'); return true;
  }catch(e){ updateApiStatus(provider,'error','Network error'); return false; }
}

async function queryAI(provider, query, apiKey){
  const start=Date.now();
  try{
    const body={model:provider==='ollama'?'ollama-beta':'deepseek-chat', messages:[{role:'user', content:query}], max_tokens:1000, temperature:0.7};
    const res = await fetch(API_CONFIG[provider].baseURL+API_CONFIG[provider].endpoints.chat,{method:'POST', headers:{'Authorization':`Bearer ${apiKey}`,'Content-Type':'application/json'}, body:JSON.stringify(body)});
    if(!res.ok) throw new Error(`API error ${res.status}`);
    const data = await res.json();
    return {success:true, content:data.choices[0].message.content, responseTime:Date.now()-start};
  }catch(e){ return {success:false, error:e.message, responseTime:Date.now()-start}; }
}

async function performSearch(){
  const query=document.getElementById('searchInput').value.trim();
  const provider=document.getElementById('aiProvider').value;
  if(!query){ alert('Please enter a search query!'); return; }

  document.getElementById('loading').classList.add('active');
  document.getElementById('resultsSection').classList.remove('active');
  document.getElementById('searchBtn').disabled=true;

  let resultsHTML='';
  const providersToQuery=provider==='compare'?['deepseek','ollama']:[provider];

  for(const p of providersToQuery){
    const apiKey=document.getElementById(p+'Key').value;
    if(!apiKey){ resultsHTML+=`<div class="response-card"><div class="error">❌ ${API_CONFIG[p].name} API key not configured</div></div>`; continue; }
    const result = await queryAI(p,query,apiKey);
    resultsHTML+=`<div class="response-card">
      <div class="response-header"><div class="provider-badge">${API_CONFIG[p].name}</div><div class="response-time">${result.responseTime}ms</div></div>
      <div class="response-content">${result.success?result.content:`<div class="error">❌ ${result.error}</div>`}</div>
    </div>`;
  }

  document.getElementById('resultsArea').innerHTML=resultsHTML;
  document.getElementById('loading').classList.remove('active');
  document.getElementById('resultsSection').classList.add('active');
  document.getElementById('searchBtn').disabled=false;
  document.getElementById('statusText').textContent='APP: Search completed';
}

document.getElementById('testApisBtn').addEventListener('click', async ()=>{
  document.getElementById('statusText').textContent='APP: Testing API connections...';
  const results = await Promise.all([testApiConnection('deepseek'), testApiConnection('ollama')]);
  const connectedCount = results.filter(Boolean).length;
  if(connectedCount>0){
    document.getElementById('globalStatus').className='global-status connected';
    document.getElementById('searchSection').classList.add('active');
    document.getElementById('statusText').textContent=`APP: ${connectedCount}/2 APIs connected - Ready for search`;
  }else{ document.getElementById('statusText').textContent='APP: No APIs connected - Please configure keys'; }
});

document.getElementById('saveConfigBtn').addEventListener('click', ()=>{
  ['deepseek','ollama'].forEach(p=>{ const key=document.getElementById(p+'Key').value; if(key){ localStorage.setItem(p+'_api_key',key); updateApiStatus(p,'saved'); } });
  alert('API keys saved locally!');
});

document.getElementById('searchBtn').addEventListener('click', performSearch);
loadApiKeys();
</script>
</body>
</html>
